# 地图演示项目

这是一个基于Leaflet的地图演示项目，支持高德地图底图和自定义瓦片层，专注于北京天安门区域。

## 功能特性

- 🗺️ **高德地图底图**: 使用高德地图瓦片服务作为底图
- 🏛️ **北京天安门区域**: 预设北京天安门广场为中心，包含周边地标
- 🎨 **自定义瓦片层**: 支持自定义瓦片覆盖层，可切换显示
- 🔍 **交互操作**: 支持缩放、拖拽、点击标记等操作
- 📍 **地标标记**: 包含天安门、故宫、景山公园等北京地标
- 📱 **响应式设计**: 适配不同屏幕尺寸

## 技术栈

- **后端**: Deno + TypeScript
- **前端**: Leaflet.js + 原生JavaScript
- **地图服务**: 高德地图瓦片API
- **瓦片格式**: PNG (256x256)

## 快速开始

### 1. 安装Deno

确保您的系统已安装Deno。如果未安装，请访问 [Deno官网](https://deno.land/) 进行安装。

### 2. 启动服务器

```bash
deno run --allow-net --allow-read --allow-env main.ts
```

### 3. 访问地图

打开浏览器访问: http://localhost:8000

## 项目结构

```
mapDemo/
├── main.ts              # 服务器主文件
├── deno.json           # Deno配置文件
├── public/
│   └── index.html      # 前端页面
├── tiles/              # 瓦片文件目录
│   ├── 8/109/39/       # 北京区域瓦片 (缩放级别8)
│   ├── 9/218/78/       # 北京区域瓦片 (缩放级别9)
│   ├── 10/436/156/     # 北京区域瓦片 (缩放级别10)
│   ├── 11/872/312/     # 北京区域瓦片 (缩放级别11)
│   └── 12/1744/624/    # 北京区域瓦片 (缩放级别12)
└── README.md           # 项目说明
```

## 瓦片系统

### 高德地图瓦片

- **URL格式**: `https://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}`
- **子域名**: 1, 2, 3, 4 (随机选择)
- **样式**: 6 (标准地图样式)

### 自定义瓦片

- **北京天安门区域**: 自动生成包含街道、建筑物、公园的详细地图
- **其他区域**: 生成简单的网格瓦片
- **格式**: PNG (256x256像素)

## 操作说明

- **缩放**: 使用鼠标滚轮进行缩放，或使用右侧控制面板的滑块
- **拖拽**: 按住鼠标左键拖拽地图
- **坐标控制**: 右侧控制面板可调整纬度和经度
- **重置到北京**: 点击"重置到北京"按钮回到天安门广场
- **切换自定义层**: 点击"切换自定义层"按钮显示/隐藏自定义瓦片层
- **地标信息**: 点击地图上的标记查看地标详细信息

## 开发说明

### 添加新的地标

在 `index.html` 的 `landmarks` 数组中添加新的地标：

```javascript
{
    name: "地标名称",
    coords: [纬度, 经度],
    description: "地标描述"
}
```

### 修改地图中心位置

修改 `BEIJING_CENTER` 常量来改变初始地图中心：

```javascript
const BEIJING_CENTER = [纬度, 经度];
```

### 自定义瓦片样式

修改 `main.ts` 中的 `generateBeijingTile` 和 `generateSimpleTile` 函数中的Canvas绘制代码。

### 添加新的地图层

使用Leaflet的 `L.tileLayer` 创建新的瓦片层：

```javascript
const newLayer = L.tileLayer('瓦片URL模板', {
    attribution: '图层说明',
    maxZoom: 18,
    minZoom: 8
});
```

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request！
